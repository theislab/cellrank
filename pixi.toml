# Pixi environments for conda-dependent CI (PETSc/SLEPc, R).
# Main development uses hatch/uv; pixi is CI-only.

[workspace]
name = "cellrank"
channels = ["conda-forge"]
platforms = ["linux-64"]

# Shared test dependencies (pixi doesn't install dependency-groups from
# editable PyPI packages, so test deps must be declared here).
[feature.test.dependencies]
pytest = ">=8"
pytest-cov = ">=4"
pytest-mock = ">=3.5"
pytest-xdist = "*"
coverage = ">=7"
igraph = "*"
leidenalg = "*"
pillow = "*"
zarr = "<3"

[feature.slepc.dependencies]
petsc = "*"
slepc = "*"
petsc4py = "*"
slepc4py = "*"
mpi4py = "*"

[feature.slepc.pypi-dependencies]
cellrank = { path = ".", editable = true }

[feature.slepc.tasks]
test = "pytest tests/ -v --cov --cov-report=xml"

[feature.r.dependencies]
r-mgcv = "*"
rpy2 = "*"

[feature.r.pypi-dependencies]
cellrank = { path = ".", editable = true }

[feature.r.tasks]
test = "pytest tests/ -v --cov --cov-report=xml"

[environments]
slepc = ["test", "slepc"]
r = ["test", "r"]
